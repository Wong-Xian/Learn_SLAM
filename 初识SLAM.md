# 惯性测量单元 IMU

1. 加速度原理
    1. 线位移式
    2. 摆式
2. 角速度原理
    1. 激光陀螺仪
    2. MEMS微机电陀螺仪角速度
3. 磁力原理
    1. 霍尔效应
    2. 洛伦兹力

# IMU 原始数据采集

- 9轴IMU
  - 3轴加速度
  - 3轴角速度
  - 3轴磁力
- IMU 性能参数
  - 量程
  - 非线性度
  - 零点偏移
  - 轴间灵敏度
  - 噪声密度
  - 温度漂移

# 库介绍

## OpenCV

- 计算机视觉库

## Eigen

- 线性代数运算库

## Sophus

- 李群运算库

## ROS

- 机器人操作系统，一系列帮助构建机器人应用的库
- The Robot Operating System (ROS) is a set of software libraries and tools that help you build robot applications.

## Point Cloud

- 点云库，处理点云的库
- The Point Cloud Library (PCL) is a standalone, large scale, open project for 2D/3D image and point cloud processing.

# 入门 SLAM

2023年8月3日

- 安装 ROS

# 《视觉SLAM十四讲》

2.2 经典视觉SLAM框架

1. 传感器信息获取
2. 前端视觉里程计(Visual Odometry, VO)
   1. 相邻图象之间，相机的运动。
   2. 累积漂移(Accumulating Drift)：在最简单地估算两帧图像时产生的误差，随着估算的进行不断累积。
3. 后端（非线性）优化(Optimazation)
   1. 处理噪声问题。
4. 回环检测(Loop Closure Detection)
   1. 机器人回到了原点，但由于漂移，其位置估计值没有回到原点的现象。
   2. 需要后端具有“识别到过的场景”的能力。
5. 建图(Mapping)
   1. 【度量地图】
      1. 强调精确表示地图中物体的位置关系。
      2. 稀疏(Sparse)地图（定位用）选取部分具有代表性的东西(路标Landmark)
      3. 稠密地图（导航用）着重于建模所有看到的东西
   2. 【拓扑地图】
      1. 强调地图中元素之间的关系

2.4 实践：编程基础

2.4.3 使用cmake

- cmake 生成 makefile，再用 make 命令编译程序。
- add_library() 命令可以添加库
- Linux 中库分为
  - 静态库 后缀为.a 静态库每次被调用都会生成一个副本
  - 共享库 后缀为.so 共享库则只有一个副本
- target_link_libraries(*1 *2) 函数使 *1 文件可以调用 *2 库中的函数。

2.4.5 使用 IDE

推荐 kdevelop 软件。

## 第3章 三维空间刚体运动

主要目标：
- 理解三位空间刚体运动的描述方式：平移（好说） + 旋转（麻烦）
  - 旋转矩阵
  - 变换矩阵
  - 四元数
  - 欧拉角
- 掌握Eigen库中 矩阵、几何模块 的使用方法

### 3.1 旋转矩阵

- 3.1.1 点和向量，坐标系
  - 不能像中学物理那样把物体运动当做质点来考虑了，而要当成刚体来考虑，考虑刚体，则必须考虑自身姿态的问题。
  - 点与向量
    - 点：物体在空间中的位置。
    - 向量：注意区分向量、基和坐标的区别。
  - 内积与外积
    - 外积：法向量，垂直于a、b，且其模等于a、b构成平行四边形的面积。【外积可以表示旋转！】
    - 内积：太熟悉了，略。
- 3.1.2 坐标系间的欧式变换
  - 坐标变换：对于同一个向量p，它在世界坐标系下的坐标pw和在相机坐标系下的坐标pc是不同的。变换关系由坐标系间的变换矩阵T来描述。
  - 欧式变换：同一个向量在各个坐标系下的长度和夹角都不会变化。
  - 旋转矩阵：可描述相机的旋转。
- 3.1.3 变换矩阵 与 齐次坐标
  - 存在问题：多次变化不满足线性关系
  - 解决方法：引入齐次坐标 和 变换矩阵重写式

### 3.2 实践：Eigen库

略

### 3.3 旋转向量 和 欧拉角

- 3.3.1 旋转向量
  - 提出问题（存在不足）
    - 旋转矩阵有9个量，但一次旋转只有3个自由度，因此该表达方式有冗余。
    - 旋转矩阵自身有约束：自身是正交矩阵，行列式为1。
  - 旋转向量：其方向与旋转轴一致，长度等于旋转角。（用外积表达两个向量的旋转关系）（优势：用一个三维向量描述旋转）
- 3.3.2 欧拉角
  - 存在问题：矩阵对人来说不直观，很难看出其描述的旋转。
  - 欧拉角：使用3个分离的转角，直观描述旋转。有多种定义方式
  - 航空中的例子：yaw-pitch-roll 偏航-俯仰-滚转

### 3.4 四元数

- 3.4.1 四元数的定义
  - 类比复数的乘法表示对复平面向量的旋转；对三维空间的旋转用到的就是四元数。其本质是扩展的复数。
  - 优点：它是紧凑的，没有奇异性。
  - 缺点：不直观，运算复杂。
  - 表示：q = q0 + q1i + q2j + q3k. i j k 分别是3个虚部，q0是实部。
- 3.4.2 四元数的运算
  - 加减法：虚部实部直接相加减
  - 乘法：相乘的两个四元数的各项分别相乘，涉及虚部的相乘按照规定判定正负。
  - 共轭：虚部取相反数。
  - 模长：根号下平方和。
  - 逆：共轭 除以 模长的平方。
  - 数乘 点乘：数乘是实部虚部直接乘，点乘是两个四元数对应位置上的系数相乘。
- 3.4.3 用四元数表示旋转
  - 略
- 3.4.4 四元数 到 旋转矩阵 的转换
  - 公式

## 总结
无论是四元数、欧拉角还是旋转矩阵，

### 3.5 相似、仿射、射影 变换

略

### 3.6 实践：Eigen库几何模块

略

### 3.7 可视化演示

## 第四章 李群 李代数

### 4.1 李群 李代数 基础

旋转矩阵：特殊正交群 SO(3) Set Orthoganal
变换矩阵：特殊欧氏群 SE(3) Set Euclidean

对加法不封闭，对乘法封闭。

- 4.1.1 群
  - 群的定义：只有一种运算的集合，运算完后的结果仍属于原集合。群是一种集合加运算的代数结构。
  - 满足性质：
    - 封闭性：两个元素运算后，仍属于该群
    - 结合律：类似加法结合律
    - 幺元：任何元素乘以它等于元素自身，类似数集里的1
    - 逆：群中任意元素的逆也属于该群，且元素与其逆相乘等于幺元。
  - 李群：是指具有连续（光滑）性质的群。
    - 整数群是离散的，不是李群。
    - SO(n)和SE(n)在实数空间上是连续的，是李群。
- 4.1.2 李代数的引出
  - φ 描述了 R 在局部的导数关系
- 4.1.3 李代数的定义
  - 李代数描述了李群的局部性质。
  - 李代数的组成
    - 集合
    - 数域
    - 二元运算
  - 满足性质
    - 封闭性
    - 双线性
    - 自反性：某元素与自己进行二元运算，结果为0
    - 雅可比等价：[X,[Y,Z]]+[Y,[Z,X]]+[Z,[X,Y]]=0
  - 二元运算 也被称为 李括号
- 4.1.4 李代数 so(3)
  - 三维向量组成的集合，每个向量对应到一个反对称矩阵，可以表达旋转矩阵的导数
- 4.1.5 李代数 se(3)
  - 由一个平移加上 so(3) 元素构成的向量。

### 4.2 指数 与 对数 映射

- 4.2.1 SO(3) 上的指数映射
  - so(3) 实际上就是由所谓的旋转向量 组成的空间
- 4.2.2 SE(3) 上的指数映射

### 4.3 李代数求导与扰动模型

### 4.4 实践：Sophus

### 4.5 相似变换 与 李代数

### 4.6 小结

# 概念辨析

- 单目相机(Monocular)
- 双目相机(Stereo)
- 深度相机(RGB-D)
- 视差(Disparity)：相机移动时，离相机距离近的物体移动块，离相机远的物体移动慢。
- 尺度(Scale)：单目 SLAM 估计的轨迹和地图 与 真实轨迹和地图 相差一个因子。
- 尺度不确定性(Scale Ambiguity)：单目 SLAM 无法仅凭图象确定真实尺度。
- 基线(Baseline)：双目相机两个相机之间的距离。
- SIFT (Scale-invariant feature transform)特征
  - 尺度空间极值检测：通过使用高斯差分函数来计算并搜索所有尺度上的图像位置，用于识别对尺度和方向不变的潜在兴趣点。
  - 关键点定位：通过一个拟合精细的模型在每个候选位置上确定位置和尺度；关键点的选择依赖于它们的稳定程度。
  - 方向匹配：基于局部图像的梯度方向，为每个关键点位置分配一个或多个方向，后续所有对图像数据的操作都是相对于关键点的方向、尺度和位置进行变换，从而为这些变换提供了不变形。
  - 关键点描述：这个和 HOG 算法有点类似之处，在每个关键点周围的区域内以选定的比例计算局部图像梯度，这些梯度被变换成一种表示，这种表示允许比较大的局部形状的变形和光照变化。
  - 包括两个部分
    - 特征提取
      - 候选关键点：通过DOG比较临近像素可以检测出候选关键点
      - 关键点定位
    - 特征描述
      - 方向分配
      - 局部特征描述
- ORB 特征(Oriented FAST and Rotated BRIEF)
  - FAST
    - 解决 SIFT 慢的问题
    - 解决特征点寻找的问题
  - BRIEF(Binary Robust Independent Elementary Features)
    - 解决描述子构造的问题
- BA (Bundle Adjustment)实现
  - 在仅给定相机内部矩阵的条件下，对四周物体进行高精度重建。
  - 利用非线性最小二乘法来求取相机位姿，三维点坐标。

# B站 古月居 SLAM 视频

## ROS 中结点间的通信机制
- ROS 中的结点：就是进程
- 结点间的通信机制
  - 发布订阅模式：一个结点发布，可以有多个结点订阅，非实时。
  - 服务器客户端模式：客户端发送请求，服务器立即返回应答，实时。